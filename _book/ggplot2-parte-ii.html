<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Introdução a R para Visualização e Apresentação de Dados</title>
  <meta name="description" content="Introdução a R para Visualização e Apresentação de Dados">
  <meta name="generator" content="bookdown 0.7 and GitBook 2.6.7">

  <meta property="og:title" content="Introdução a R para Visualização e Apresentação de Dados" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Introdução a R para Visualização e Apresentação de Dados" />
  
  
  

<meta name="author" content="Sillas Gonzaga">


<meta name="date" content="2018-08-27">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="introducao-ao-ggplot2.html">
<link rel="next" href="outros-tipos-de-graficos.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="libs/htmlwidgets-1.2/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.8.0/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.0.0/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.0.0/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-1.39.2/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-1.39.2/plotly-latest.min.js"></script>
<link href="libs/leaflet-0.7.7/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-0.7.7/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<link href="libs/leaflet-label-0.2.2/leaflet.label.css" rel="stylesheet" />
<script src="libs/leaflet-label-0.2.2/leaflet.label.js"></script>
<script src="libs/Proj4Leaflet-0.7.2/proj4-compressed.js"></script>
<script src="libs/Proj4Leaflet-0.7.2/proj4leaflet.js"></script>
<script src="libs/leaflet-binding-1.1.0/leaflet.js"></script>
<link href="libs/sequences-0.1/sequences.css" rel="stylesheet" />
<script src="libs/sunburst-binding-2.0.0/sunburst.js"></script>
<script src="libs/datatables-binding-0.2/datatables.js"></script>
<link href="libs/dt-core-1.10.12/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.10.12/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.10.12/js/jquery.dataTables.min.js"></script>


<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li> <img src="https://i.imgur.com/x4ZQ8E3.png" alt="" style="width:200px;height:100px;" class="center"> </li>
<li><strong><a href="./">Introdução ao R para Visualização de Dados</a></strong></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Boas-vindas</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#sobre-o-instrutor"><i class="fa fa-check"></i>Sobre o instrutor</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#referencias"><i class="fa fa-check"></i>Referências</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="breve-introducao-ao-r.html"><a href="breve-introducao-ao-r.html"><i class="fa fa-check"></i><b>1</b> Breve introdução ao R</a><ul>
<li class="chapter" data-level="1.1" data-path="breve-introducao-ao-r.html"><a href="breve-introducao-ao-r.html#objetivo"><i class="fa fa-check"></i><b>1.1</b> Objetivo</a></li>
<li class="chapter" data-level="1.2" data-path="breve-introducao-ao-r.html"><a href="breve-introducao-ao-r.html#introducao-ao-r"><i class="fa fa-check"></i><b>1.2</b> Introdução ao R</a></li>
<li class="chapter" data-level="1.3" data-path="breve-introducao-ao-r.html"><a href="breve-introducao-ao-r.html#leitura-de-dados-com-readr"><i class="fa fa-check"></i><b>1.3</b> Leitura de dados com readr</a></li>
<li class="chapter" data-level="1.4" data-path="breve-introducao-ao-r.html"><a href="breve-introducao-ao-r.html#dplyr"><i class="fa fa-check"></i><b>1.4</b> dplyr</a><ul>
<li class="chapter" data-level="1.4.1" data-path="breve-introducao-ao-r.html"><a href="breve-introducao-ao-r.html#select"><i class="fa fa-check"></i><b>1.4.1</b> select()</a></li>
<li class="chapter" data-level="1.4.2" data-path="breve-introducao-ao-r.html"><a href="breve-introducao-ao-r.html#filter"><i class="fa fa-check"></i><b>1.4.2</b> filter()</a></li>
<li class="chapter" data-level="1.4.3" data-path="breve-introducao-ao-r.html"><a href="breve-introducao-ao-r.html#mutate"><i class="fa fa-check"></i><b>1.4.3</b> mutate()</a></li>
<li class="chapter" data-level="1.4.4" data-path="breve-introducao-ao-r.html"><a href="breve-introducao-ao-r.html#arrange"><i class="fa fa-check"></i><b>1.4.4</b> arrange()</a></li>
<li class="chapter" data-level="1.4.5" data-path="breve-introducao-ao-r.html"><a href="breve-introducao-ao-r.html#group_by-e-summarise"><i class="fa fa-check"></i><b>1.4.5</b> group_by() e summarise()</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="breve-introducao-ao-r.html"><a href="breve-introducao-ao-r.html#juntando-duas-tabelas-em-uma"><i class="fa fa-check"></i><b>1.5</b> Juntando duas tabelas em uma</a></li>
<li class="chapter" data-level="1.6" data-path="breve-introducao-ao-r.html"><a href="breve-introducao-ao-r.html#tidyr"><i class="fa fa-check"></i><b>1.6</b> tidyr</a></li>
<li class="chapter" data-level="1.7" data-path="breve-introducao-ao-r.html"><a href="breve-introducao-ao-r.html#exercicios"><i class="fa fa-check"></i><b>1.7</b> Exercícios</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="introducao-ao-ggplot2.html"><a href="introducao-ao-ggplot2.html"><i class="fa fa-check"></i><b>2</b> Introdução ao ggplot2</a><ul>
<li class="chapter" data-level="2.1" data-path="introducao-ao-ggplot2.html"><a href="introducao-ao-ggplot2.html#dataset-do-modulo"><i class="fa fa-check"></i><b>2.1</b> Dataset do módulo</a></li>
<li class="chapter" data-level="2.2" data-path="introducao-ao-ggplot2.html"><a href="introducao-ao-ggplot2.html#ggplot2-filosofia-do-pacote-e-do-grammar-of-graphics"><i class="fa fa-check"></i><b>2.2</b> ggplot2: filosofia do pacote e do Grammar of Graphics</a></li>
<li class="chapter" data-level="2.3" data-path="introducao-ao-ggplot2.html"><a href="introducao-ao-ggplot2.html#geoms"><i class="fa fa-check"></i><b>2.3</b> geoms</a><ul>
<li class="chapter" data-level="2.3.1" data-path="introducao-ao-ggplot2.html"><a href="introducao-ao-ggplot2.html#geom_bar-e-geom_col"><i class="fa fa-check"></i><b>2.3.1</b> geom_bar() e geom_col()</a></li>
<li class="chapter" data-level="2.3.2" data-path="introducao-ao-ggplot2.html"><a href="introducao-ao-ggplot2.html#geom_point"><i class="fa fa-check"></i><b>2.3.2</b> geom_point()</a></li>
<li class="chapter" data-level="2.3.3" data-path="introducao-ao-ggplot2.html"><a href="introducao-ao-ggplot2.html#geom_line"><i class="fa fa-check"></i><b>2.3.3</b> geom_line()</a></li>
<li class="chapter" data-level="2.3.4" data-path="introducao-ao-ggplot2.html"><a href="introducao-ao-ggplot2.html#geom_histogram"><i class="fa fa-check"></i><b>2.3.4</b> geom_histogram()</a></li>
<li class="chapter" data-level="2.3.5" data-path="introducao-ao-ggplot2.html"><a href="introducao-ao-ggplot2.html#geom_text"><i class="fa fa-check"></i><b>2.3.5</b> geom_text()</a></li>
<li class="chapter" data-level="2.3.6" data-path="introducao-ao-ggplot2.html"><a href="introducao-ao-ggplot2.html#geom_hline-and-geom_vline"><i class="fa fa-check"></i><b>2.3.6</b> geom_hline() and geom_vline()</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="introducao-ao-ggplot2.html"><a href="introducao-ao-ggplot2.html#aes"><i class="fa fa-check"></i><b>2.4</b> aes</a></li>
<li class="chapter" data-level="2.5" data-path="introducao-ao-ggplot2.html"><a href="introducao-ao-ggplot2.html#a-anatomia-da-funcao-ggplot"><i class="fa fa-check"></i><b>2.5</b> A anatomia da função ggplot()</a></li>
<li class="chapter" data-level="2.6" data-path="introducao-ao-ggplot2.html"><a href="introducao-ao-ggplot2.html#segmentacao-de-um-grafico-em-grupos-com-os-facets"><i class="fa fa-check"></i><b>2.6</b> Segmentação de um gráfico em grupos com os facets</a></li>
<li class="chapter" data-level="2.7" data-path="introducao-ao-ggplot2.html"><a href="introducao-ao-ggplot2.html#salvando-graficos-do-ggplot2"><i class="fa fa-check"></i><b>2.7</b> Salvando gráficos do ggplot2</a></li>
<li class="chapter" data-level="2.8" data-path="introducao-ao-ggplot2.html"><a href="introducao-ao-ggplot2.html#juntando-diferentes-graficos-em-um-so"><i class="fa fa-check"></i><b>2.8</b> Juntando diferentes gráficos em um só</a></li>
<li class="chapter" data-level="2.9" data-path="introducao-ao-ggplot2.html"><a href="introducao-ao-ggplot2.html#graficos-no-r-alem-de-ggplot2"><i class="fa fa-check"></i><b>2.9</b> Gráficos no R além de ggplot2</a></li>
<li class="chapter" data-level="2.10" data-path="introducao-ao-ggplot2.html"><a href="introducao-ao-ggplot2.html#exercicios-1"><i class="fa fa-check"></i><b>2.10</b> Exercícios</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="ggplot2-parte-ii.html"><a href="ggplot2-parte-ii.html"><i class="fa fa-check"></i><b>3</b> ggplot2 - parte II</a><ul>
<li class="chapter" data-level="3.1" data-path="ggplot2-parte-ii.html"><a href="ggplot2-parte-ii.html#graficos-de-relacionamentos-entre-variaveis-continuas-scatter-plot"><i class="fa fa-check"></i><b>3.1</b> Gráficos de relacionamentos entre variáveis contínuas: scatter plot</a></li>
<li class="chapter" data-level="3.2" data-path="ggplot2-parte-ii.html"><a href="ggplot2-parte-ii.html#graficos-de-barras-ou-colunas"><i class="fa fa-check"></i><b>3.2</b> Gráficos de barras ou colunas</a><ul>
<li class="chapter" data-level="3.2.1" data-path="ggplot2-parte-ii.html"><a href="ggplot2-parte-ii.html#invertendo-eixos"><i class="fa fa-check"></i><b>3.2.1</b> Invertendo eixos</a></li>
<li class="chapter" data-level="3.2.2" data-path="ggplot2-parte-ii.html"><a href="ggplot2-parte-ii.html#como-mudar-a-ordem-das-barras"><i class="fa fa-check"></i><b>3.2.2</b> Como mudar a ordem das barras</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="ggplot2-parte-ii.html"><a href="ggplot2-parte-ii.html#graficos-de-distribuicoes"><i class="fa fa-check"></i><b>3.3</b> Gráficos de distribuições</a><ul>
<li class="chapter" data-level="3.3.1" data-path="ggplot2-parte-ii.html"><a href="ggplot2-parte-ii.html#histogramas"><i class="fa fa-check"></i><b>3.3.1</b> Histogramas</a></li>
<li class="chapter" data-level="3.3.2" data-path="ggplot2-parte-ii.html"><a href="ggplot2-parte-ii.html#grafico-de-densidade"><i class="fa fa-check"></i><b>3.3.2</b> Gráfico de densidade</a></li>
<li class="chapter" data-level="3.3.3" data-path="ggplot2-parte-ii.html"><a href="ggplot2-parte-ii.html#boxplot"><i class="fa fa-check"></i><b>3.3.3</b> Boxplot</a></li>
<li class="chapter" data-level="3.3.4" data-path="ggplot2-parte-ii.html"><a href="ggplot2-parte-ii.html#jitter"><i class="fa fa-check"></i><b>3.3.4</b> Jitter</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="ggplot2-parte-ii.html"><a href="ggplot2-parte-ii.html#graficos-de-series-temporais-linhas"><i class="fa fa-check"></i><b>3.4</b> Gráficos de séries temporais (linhas)</a></li>
<li class="chapter" data-level="3.5" data-path="ggplot2-parte-ii.html"><a href="ggplot2-parte-ii.html#mapas-de-calor"><i class="fa fa-check"></i><b>3.5</b> Mapas de calor</a></li>
<li class="chapter" data-level="3.6" data-path="ggplot2-parte-ii.html"><a href="ggplot2-parte-ii.html#customizando-escalas"><i class="fa fa-check"></i><b>3.6</b> Customizando escalas</a></li>
<li class="chapter" data-level="3.7" data-path="ggplot2-parte-ii.html"><a href="ggplot2-parte-ii.html#texto"><i class="fa fa-check"></i><b>3.7</b> Texto</a></li>
<li class="chapter" data-level="3.8" data-path="ggplot2-parte-ii.html"><a href="ggplot2-parte-ii.html#areas-ou-faixas-sombreadas"><i class="fa fa-check"></i><b>3.8</b> Áreas ou faixas sombreadas</a></li>
<li class="chapter" data-level="3.9" data-path="ggplot2-parte-ii.html"><a href="ggplot2-parte-ii.html#alterando-aspectos-visuais-do-grafico-com-os-temas"><i class="fa fa-check"></i><b>3.9</b> Alterando aspectos visuais do gráfico com os temas</a></li>
<li class="chapter" data-level="3.10" data-path="ggplot2-parte-ii.html"><a href="ggplot2-parte-ii.html#titulos"><i class="fa fa-check"></i><b>3.10</b> Títulos</a></li>
<li class="chapter" data-level="3.11" data-path="ggplot2-parte-ii.html"><a href="ggplot2-parte-ii.html#extensoes-do-ggplot2"><i class="fa fa-check"></i><b>3.11</b> Extensões do ggplot2</a></li>
<li class="chapter" data-level="3.12" data-path="ggplot2-parte-ii.html"><a href="ggplot2-parte-ii.html#exercicios-2"><i class="fa fa-check"></i><b>3.12</b> Exercícios</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="outros-tipos-de-graficos.html"><a href="outros-tipos-de-graficos.html"><i class="fa fa-check"></i><b>4</b> Outros tipos de gráficos</a><ul>
<li class="chapter" data-level="4.1" data-path="outros-tipos-de-graficos.html"><a href="outros-tipos-de-graficos.html#transformando-graficos-do-ggplot2-em-interativos"><i class="fa fa-check"></i><b>4.1</b> Transformando gráficos do ggplot2 em interativos</a><ul>
<li class="chapter" data-level="4.1.1" data-path="outros-tipos-de-graficos.html"><a href="outros-tipos-de-graficos.html#salvando-um-grafico-ggplotly"><i class="fa fa-check"></i><b>4.1.1</b> Salvando um gráfico ggplotly</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="outros-tipos-de-graficos.html"><a href="outros-tipos-de-graficos.html#mapas-plotando-poligonos"><i class="fa fa-check"></i><b>4.2</b> Mapas: plotando polígonos</a><ul>
<li class="chapter" data-level="4.2.1" data-path="outros-tipos-de-graficos.html"><a href="outros-tipos-de-graficos.html#projeto-plotando-o-resultado-do-segundo-turno-das-eleicoes-para-presidente-de-2014-por-uf"><i class="fa fa-check"></i><b>4.2.1</b> Projeto: plotando o resultado do segundo turno das eleições para presidente de 2014 por UF:</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="outros-tipos-de-graficos.html"><a href="outros-tipos-de-graficos.html#mapas-plotando-pontos-com-google-maps"><i class="fa fa-check"></i><b>4.3</b> Mapas: plotando pontos com Google Maps</a></li>
<li class="chapter" data-level="4.4" data-path="outros-tipos-de-graficos.html"><a href="outros-tipos-de-graficos.html#mapas-interativos"><i class="fa fa-check"></i><b>4.4</b> Mapas interativos</a></li>
<li class="chapter" data-level="4.5" data-path="outros-tipos-de-graficos.html"><a href="outros-tipos-de-graficos.html#graficos-de-dados-hierarquicos-treemaps-e-sunburst"><i class="fa fa-check"></i><b>4.5</b> Gráficos de dados hierárquicos: treemaps e sunburst</a></li>
<li class="chapter" data-level="4.6" data-path="outros-tipos-de-graficos.html"><a href="outros-tipos-de-graficos.html#exercicios-3"><i class="fa fa-check"></i><b>4.6</b> Exercícios</a><ul>
<li class="chapter" data-level="" data-path="outros-tipos-de-graficos.html"><a href="outros-tipos-de-graficos.html#plotly"><i class="fa fa-check"></i>plotly</a></li>
<li class="chapter" data-level="" data-path="outros-tipos-de-graficos.html"><a href="outros-tipos-de-graficos.html#geom_sf"><i class="fa fa-check"></i>geom_sf</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="apresentacao-de-dados-com-relatorios.html"><a href="apresentacao-de-dados-com-relatorios.html"><i class="fa fa-check"></i><b>5</b> Apresentação de dados com relatórios</a><ul>
<li class="chapter" data-level="5.1" data-path="apresentacao-de-dados-com-relatorios.html"><a href="apresentacao-de-dados-com-relatorios.html#primeiros-passos-com-r-markdown"><i class="fa fa-check"></i><b>5.1</b> Primeiros passos com R Markdown</a></li>
<li class="chapter" data-level="5.2" data-path="apresentacao-de-dados-com-relatorios.html"><a href="apresentacao-de-dados-com-relatorios.html#resumo-da-sintaxe-markdown"><i class="fa fa-check"></i><b>5.2</b> Resumo da sintaxe Markdown</a><ul>
<li class="chapter" data-level="5.2.1" data-path="apresentacao-de-dados-com-relatorios.html"><a href="apresentacao-de-dados-com-relatorios.html#formatacao-de-texto"><i class="fa fa-check"></i><b>5.2.1</b> Formatação de texto</a></li>
<li class="chapter" data-level="5.2.2" data-path="apresentacao-de-dados-com-relatorios.html"><a href="apresentacao-de-dados-com-relatorios.html#cabecalhos"><i class="fa fa-check"></i><b>5.2.2</b> Cabeçalhos</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="apresentacao-de-dados-com-relatorios.html"><a href="apresentacao-de-dados-com-relatorios.html#chunks"><i class="fa fa-check"></i><b>5.3</b> Chunks</a></li>
<li class="chapter" data-level="5.4" data-path="apresentacao-de-dados-com-relatorios.html"><a href="apresentacao-de-dados-com-relatorios.html#formatos-de-output"><i class="fa fa-check"></i><b>5.4</b> Formatos de output</a></li>
<li class="chapter" data-level="5.5" data-path="apresentacao-de-dados-com-relatorios.html"><a href="apresentacao-de-dados-com-relatorios.html#compilando-um-documento-rmarkdown"><i class="fa fa-check"></i><b>5.5</b> Compilando um documento rmarkdown</a></li>
<li class="chapter" data-level="5.6" data-path="apresentacao-de-dados-com-relatorios.html"><a href="apresentacao-de-dados-com-relatorios.html#produzindo-tabelas-no-r-markdown"><i class="fa fa-check"></i><b>5.6</b> Produzindo tabelas no R Markdown</a></li>
<li class="chapter" data-level="5.7" data-path="apresentacao-de-dados-com-relatorios.html"><a href="apresentacao-de-dados-com-relatorios.html#relatorios-parametrizados"><i class="fa fa-check"></i><b>5.7</b> Relatórios parametrizados</a><ul>
<li class="chapter" data-level="5.7.1" data-path="apresentacao-de-dados-com-relatorios.html"><a href="apresentacao-de-dados-com-relatorios.html#declarando-parametros"><i class="fa fa-check"></i><b>5.7.1</b> Declarando parâmetros</a></li>
<li class="chapter" data-level="5.7.2" data-path="apresentacao-de-dados-com-relatorios.html"><a href="apresentacao-de-dados-com-relatorios.html#usando-os-parametros"><i class="fa fa-check"></i><b>5.7.2</b> Usando os parâmetros</a></li>
</ul></li>
<li class="chapter" data-level="5.8" data-path="apresentacao-de-dados-com-relatorios.html"><a href="apresentacao-de-dados-com-relatorios.html#projeto-final"><i class="fa fa-check"></i><b>5.8</b> Projeto final</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Introdução a R para Visualização e Apresentação de Dados</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="ggplot2---parte-ii" class="section level1">
<h1><span class="header-section-number">Módulo 3</span> ggplot2 - parte II</h1>
<p>Neste módulo, usaremos estes pacotes. Confira se você já os tem instalados:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(tidyverse)
<span class="kw">library</span>(janitor)
<span class="kw">library</span>(readxl)
<span class="co"># interface com series temporais do banco central:</span>
<span class="kw">library</span>(rbcb) <span class="co"># install.packages(&#39;rbcb&#39;)</span>
<span class="co"># jaja explico :)</span>
<span class="kw">library</span>(ggrepel) <span class="co"># install.packages(&#39;ggrepel&#39;)</span></code></pre></div>
<p>Usaremos o dataset do índice de felicidade salvo anteriormente:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># importar dataset</span>
df_feliz &lt;-<span class="st"> </span><span class="kw">read_rds</span>(<span class="st">&quot;dados_felicidade_2017.rds&quot;</span>)
<span class="kw">head</span>(df_feliz)</code></pre></div>
<pre><code>## # A tibble: 6 x 12
##   country  year life_ladder log_gdp_per_cap… social_support
##   &lt;chr&gt;   &lt;int&gt;       &lt;dbl&gt;            &lt;dbl&gt;          &lt;dbl&gt;
## 1 Afghan…  2017        2.66             7.46          0.491
## 2 Albania  2017        4.64             9.37          0.638
## 3 Algeria  2017        5.25             9.54          0.807
## 4 Argent…  2017        6.04             9.84          0.907
## 5 Armenia  2017        4.29             9.03          0.698
## 6 Austra…  2017        7.26            10.7           0.950
## # ... with 7 more variables: healthy_life_expectancy_at_birth &lt;dbl&gt;,
## #   freedom_to_make_life_choices &lt;dbl&gt;, perceptions_of_corruption &lt;dbl&gt;,
## #   positive_affect &lt;dbl&gt;, negative_affect &lt;dbl&gt;, gini &lt;dbl&gt;,
## #   continent &lt;chr&gt;</code></pre>
<div id="graficos-de-relacionamentos-entre-variaveis-continuas-scatter-plot" class="section level2">
<h2><span class="header-section-number">3.1</span> Gráficos de relacionamentos entre variáveis contínuas: scatter plot</h2>
<p>Scatterplot, ou gráfico de pontos, é um tipo de visualização especialmente útil para observar se existe uma relação entre duas variáveis contínuas (numéricas), de que tipo ela é e se existem indivíduos que são fogem do comportamento padrão da maioria dos pontos.</p>
<p>Observer o nosso dataset do índice de felicidade. Existem várias combinações de variáveis que poderíamos olhar. Por exemplo, qual será a relação entre PIB per capita e expectativa de vida saudável?</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df_feliz <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> log_gdp_per_capita,
             <span class="dt">y =</span> healthy_life_expectancy_at_birth)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>()</code></pre></div>
<pre><code>## Warning: Removed 7 rows containing missing values (geom_point).</code></pre>
<p><img src="curso_visualizacao_files/figure-html/unnamed-chunk-63-1.png" width="672" /></p>
<p>Apenas com esse simples gráfico, aprendemos algumas informações sobre o dataset:<br />
* Conforme o esperado, existe uma correlação positiva entre as variáveis: quanto maior o PIB per capita do país, maior a expectativa de sua população.<br />
* Contudo, existem alguns pontos que fogem dessa relação, como os que possuem log PIB per capita de 8,5 mas expectativa de vida em torno de apenas 45 anos.</p>
<p>Gráficos de pontos funcionam muito bem em conjunto com <code>geom_smooth()</code>. Observe como os comentários que fizemos sobre as propriedades dessas duas variáveis ficam ainda mais evidentes após adicionar a camada <code>geom_smooth()</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df_feliz <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> log_gdp_per_capita,
             <span class="dt">y =</span> healthy_life_expectancy_at_birth)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span>
<span class="st">  </span><span class="co"># adicionar reta de ajuste de um modelo linear</span>
<span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>)</code></pre></div>
<pre><code>## Warning: Removed 7 rows containing non-finite values (stat_smooth).</code></pre>
<pre><code>## Warning: Removed 7 rows containing missing values (geom_point).</code></pre>
<p><img src="curso_visualizacao_files/figure-html/unnamed-chunk-64-1.png" width="672" /></p>
<p>A função <code>geom_point()</code> depende apenas de dois elementos obrigatórios para funcionar: <code>x</code> e <code>y</code>. Contudo, como já vimos, podemos definir opcionalmente outras propriedades visuais dos pontos, seja com valores absolutos ou mapeando variáveis a eles. Observe o exemplo abaixo:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df_feliz <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> log_gdp_per_capita,
             <span class="dt">y =</span> healthy_life_expectancy_at_birth)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">color =</span> continent))</code></pre></div>
<pre><code>## Warning: Removed 7 rows containing missing values (geom_point).</code></pre>
<p><img src="curso_visualizacao_files/figure-html/unnamed-chunk-65-1.png" width="672" /></p>
<p>Ao acrescentar o elemento de cor, aprendemos que praticamente todos os países no quadrante de baixo PIB per capita e expectativa de vida são africanos.</p>
<p>Em algumas situações, faz mais sentido usar facets para separar pontos de acordo com uma variável categórica:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df_feliz <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> log_gdp_per_capita,
             <span class="dt">y =</span> healthy_life_expectancy_at_birth)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>continent)</code></pre></div>
<pre><code>## Warning: Removed 7 rows containing missing values (geom_point).</code></pre>
<p><img src="curso_visualizacao_files/figure-html/unnamed-chunk-66-1.png" width="672" /></p>
<div class="alert alert-info" <strong="">
<p>Referências:</strong> <br> <a href="https://ggplot2.tidyverse.org/reference/geom_point.html"><code>geom_point()</code></a></p>
</div>
</div>
<div id="graficos-de-barras-ou-colunas" class="section level2">
<h2><span class="header-section-number">3.2</span> Gráficos de barras ou colunas</h2>
<p>Gráficos de barras ou colunas são uma ótima maneira de resumir um conjunto de dados, principalmente quando o objeto da análise é uma variável categórica.</p>
<p>Existem duas principais maneiras de criar um gráfico de barras no ggplot2: <code>geom_bar()</code> e <code>geom_col()</code>. <code>geom_bar</code> representa a altura de cada barra proporcional ao número de casos em cada grupo da variável categórica. Caso se deseja representar a altura das barras de acordo com alguma variável numérica presente no dataset. Assim, <code>geom_bar()</code> precisa apenas da <em>aesthetic</em> x, enquanto <code>geom_col()</code> precisa das <em>aesthetics</em> x e y, onde y é a variável numérica a qual a altura das barras representará, proporcionalmente.</p>
<p>Por exemplo, uma boa maneira de mostrar quantos países de cada continente estão presentes no nosso dataset é por meio de um gráfico de barras:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df_feliz <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> continent)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_bar</span>()</code></pre></div>
<p><img src="curso_visualizacao_files/figure-html/unnamed-chunk-67-1.png" width="672" /></p>
<p>É possível fazer exatamente o mesmo gráfico acima com <code>geom_col()</code> sendo apenas necessário transformar os dados antes:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># agrupar os dados e contar a quantidade de países por continente</span>
df_feliz <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">group_by</span>(continent) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">summarise</span>(<span class="dt">qtd_paises =</span> <span class="kw">n</span>()) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> continent, <span class="dt">y =</span> qtd_paises)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_col</span>()</code></pre></div>
<p><img src="curso_visualizacao_files/figure-html/unnamed-chunk-68-1.png" width="672" /></p>
<p>Diferentemente de <code>geom_point()</code>, a <em>aesthetic</em> <code>color</code> das barras define apenas a cor das bordas. Para mudar a cor das barras, deve-se alterar o parâmetro <code>fill</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df_feliz <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">group_by</span>(continent) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">summarise</span>(<span class="dt">qtd_paises =</span> <span class="kw">n</span>()) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> continent, <span class="dt">y =</span> qtd_paises)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_col</span>(<span class="dt">color =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;gray70&quot;</span>)</code></pre></div>
<p><img src="curso_visualizacao_files/figure-html/unnamed-chunk-69-1.png" width="672" /></p>
<p>No exemplo abaixo, usamos <code>geom_col()</code> para plotar os países com os 10 maiores índices de felicidades, com as barras coloridas pelo continente, mapeando essa variável na <em>aesthetic</em> <code>fill</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df_feliz <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="co"># selecionar o top 10 em indice de felicidade</span>
<span class="st">  </span><span class="kw">top_n</span>(<span class="dv">10</span>, life_ladder) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> country, <span class="dt">y =</span> life_ladder)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_col</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> continent))</code></pre></div>
<p><img src="curso_visualizacao_files/figure-html/unnamed-chunk-70-1.png" width="672" /></p>
<div id="invertendo-eixos" class="section level3">
<h3><span class="header-section-number">3.2.1</span> Invertendo eixos</h3>
<p>No exemplo acima, os nomes dos países se sobrepuseram devido ao seu tamanho. Nessa e em outra situações, é desejável inverter os eixos do gráfico, o que é feito com a função <code>coord_flip()</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df_feliz <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="co"># selecionar o top 10 em indice de felicidade</span>
<span class="st">  </span><span class="kw">top_n</span>(<span class="dv">10</span>, life_ladder) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> country, <span class="dt">y =</span> life_ladder)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_col</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> continent)) <span class="op">+</span>
<span class="st">  </span><span class="co"># inverter eixos</span>
<span class="st">  </span><span class="kw">coord_flip</span>()</code></pre></div>
<p><img src="curso_visualizacao_files/figure-html/unnamed-chunk-71-1.png" width="672" /></p>
</div>
<div id="como-mudar-a-ordem-das-barras" class="section level3">
<h3><span class="header-section-number">3.2.2</span> Como mudar a ordem das barras</h3>
<p>Uma tarefa muito comum ao fazer gráfico de barras é mudar a ordem das barras. Por padrão, o ggplot2 mantém a ordem dos <em>leveis</em> da variável, que é a alfabética (em casos onde ela não foi definida manualmente). É possível, no entanto, mudar a ordem das barras de forma que ela siga a mesma da variável contínua representada no gráfico ou até mesmo de uma outra presente no dataset.</p>
<p>Vamos refazer o gráfico de quantidade de países por continente, dessa vez reordenado as barras:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># agrupar os dados e contar a quantidade de países por continente</span>
df_feliz <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">group_by</span>(continent) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">summarise</span>(<span class="dt">qtd_paises =</span> <span class="kw">n</span>()) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="co"># transformar variavel continent, mudando a ordem de seus leveis</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">continent =</span> <span class="kw">reorder</span>(continent, qtd_paises)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> continent, <span class="dt">y =</span> qtd_paises)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_col</span>()</code></pre></div>
<p><img src="curso_visualizacao_files/figure-html/unnamed-chunk-72-1.png" width="672" /></p>
<p>Para inverter a ordem, isto é, plotar as barras em ordem decrescente, basta apenas escrever um sinal de menos (<code>-</code>) antes da variável contínua:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># agrupar os dados e contar a quantidade de países por continente</span>
df_feliz <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">group_by</span>(continent) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">summarise</span>(<span class="dt">qtd_paises =</span> <span class="kw">n</span>()) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="co"># transformar variavel continent, mudando a ordem de seus leveis</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">continent =</span> <span class="kw">reorder</span>(continent, <span class="op">-</span>qtd_paises)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> continent, <span class="dt">y =</span> qtd_paises)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_col</span>()</code></pre></div>
<p><img src="curso_visualizacao_files/figure-html/unnamed-chunk-73-1.png" width="672" /></p>
<div class="alert alert-info" <strong="">
<p>Referências:</strong> <br> <a href="https://ggplot2.tidyverse.org/reference/geom_bar.html"><code>geom_bar()</code> e <code>geom_col()</code></a></p>
</div>
</div>
</div>
<div id="graficos-de-distribuicoes" class="section level2">
<h2><span class="header-section-number">3.3</span> Gráficos de distribuições</h2>
<p>Existe uma família de gráficos dedicada a representar visualmente a distribuição de uma determinada variável contínua, com o objetivo de observar aspectos como média da distribuição, desvio padrão da média, presença de outliers, formato da distribuição, etc.</p>
<div id="histogramas" class="section level3">
<h3><span class="header-section-number">3.3.1</span> Histogramas</h3>
<p>Histograma é um método de sumarizar uma variável contínua a dividindo em segmentos ou intervalos (<em>bins</em>, em inglês) e contando quantas observações estão presentes em cada intervalo. O que difere o histograma de um gráfico de barras é o tipo da variável, pois o último lida com variáveis categóricas ou discretas, sendo os intervalos definidos pelos próprios valores que a variável assume, sem a necessidade de dividir em intervalos.</p>
<p>No <code>ggplot2</code>, uma camada contendo um histograma é criada usando a função <code>geom_histogram()</code>, que só precisa de um elemento <em>aesthetic</em>: a variável do eixo x, que é aquela que se deseja estudar a distribuição.</p>
<p>No nosso dataset de exemplo, o histograma pode ser usado para analisar a distribuição da expectativa de vida dos países:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df_feliz <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> healthy_life_expectancy_at_birth)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_histogram</span>()</code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="curso_visualizacao_files/figure-html/unnamed-chunk-74-1.png" width="672" /></p>
<p>A função <code>geom_histogram()</code>, por padrão, “quebra” a variável em 30 intervalos. É possível mudar esse comportamento especificando o argumento <code>bins</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># reduzindo o numero de intervalos</span>
df_feliz <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> healthy_life_expectancy_at_birth)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">bins =</span> <span class="dv">10</span>)</code></pre></div>
<p><img src="curso_visualizacao_files/figure-html/unnamed-chunk-75-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># aumentando o número de intervalos</span>
df_feliz <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> healthy_life_expectancy_at_birth)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">bins =</span> <span class="dv">40</span>)</code></pre></div>
<p><img src="curso_visualizacao_files/figure-html/unnamed-chunk-76-1.png" width="672" /></p>
<p>Outra maneira de redefinir os intervalos de um histograma é mudando o argumento <code>binwidth</code>, que controla a largura dos intervalos. Não é possível definir os argumentos <code>bins</code> e <code>binwidth</code> de uma só vez; ou um ou o outro.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df_feliz <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> healthy_life_expectancy_at_birth)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth =</span> <span class="dv">5</span>)</code></pre></div>
<p><img src="curso_visualizacao_files/figure-html/unnamed-chunk-77-1.png" width="672" /></p>
<p>No histograma acima, ao definir a largura dos intervalos como 5, o histograma criou intervalos usando como centros os números 45, 50, 55, etc. Portanto, os intervalos são [42,5 - 47,5), [47,5 - 52,5), etc.</p>
<p>É possível també definir os limites dos intervalos. Por exemplo, caso você deseje que os intervalos comecem com números que terminem em 5, deve-se alterar o argumento <code>boundary</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df_feliz <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> healthy_life_expectancy_at_birth)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth =</span> <span class="dv">5</span>, <span class="dt">boundary =</span> <span class="dv">5</span>)</code></pre></div>
<p><img src="curso_visualizacao_files/figure-html/unnamed-chunk-78-1.png" width="672" /></p>
<p>Assim, conseguimos criar uma visualização que mostra que a grande maioria dos países possui uma expectativa de vida maior que 60 anos, e que alguns poucos países possuem uma expectativa de vida menor que 50 anos e maior que 75.</p>
<p>Como você já deve ter imaginado, é possível mudar aspectos visuais do histograma alterando suas <em>aesthetics</em>, como mudar a cor do histograma por valores atributos ou mapear alguma variável à cor do histograma. Veja que a cor de um histograma é definida pela propriedade <code>fill</code>, pois <code>color</code> altera apenas a cor das bordas das barras:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df_feliz <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> healthy_life_expectancy_at_birth)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth =</span> <span class="dv">5</span>, <span class="dt">boundary =</span> <span class="dv">5</span>,
                 <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;green&quot;</span>, <span class="dt">alpha =</span> <span class="fl">0.5</span>)</code></pre></div>
<p><img src="curso_visualizacao_files/figure-html/unnamed-chunk-79-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df_feliz <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> healthy_life_expectancy_at_birth)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth =</span> <span class="dv">5</span>, <span class="dt">boundary =</span> <span class="dv">5</span>, <span class="kw">aes</span>(<span class="dt">fill =</span> continent))</code></pre></div>
<p><img src="curso_visualizacao_files/figure-html/unnamed-chunk-80-1.png" width="672" /></p>
<p>Histogramas agrupados, como o acima, não são muito bons para visualizar as diferenças entre os grupos. Ness caso, uma melhor alternativa é usar facets:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df_feliz <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> healthy_life_expectancy_at_birth)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth =</span> <span class="dv">5</span>, <span class="dt">boundary =</span> <span class="dv">5</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>continent, <span class="dt">ncol =</span> <span class="dv">1</span>)</code></pre></div>
<p><img src="curso_visualizacao_files/figure-html/unnamed-chunk-81-1.png" width="672" /></p>
<p>Contudo, existem maneiras melhores de visualizar a distribuição de uma variável continua segmentada por diferentes grupos, como o que tentamos fazer acima. Exemplos são os gráficos dos próximos tópicos.</p>
<div class="alert alert-info" <strong="">
<p>Referências:</strong> <a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html"><code>geom_histogram()</code></a></p>
</div>
</div>
<div id="grafico-de-densidade" class="section level3">
<h3><span class="header-section-number">3.3.2</span> Gráfico de densidade</h3>
<p>Ao trabalhar com uma variável contínua, uma alternativa a dividir os dados em intervalos e fazer um histograma é calcular a densidade de kernel estimada para a distribuição da variável. Parece complicado, mas a função <code>geom_density()</code> faz todo o trabalho por nós:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df_feliz <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> healthy_life_expectancy_at_birth)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_density</span>()</code></pre></div>
<p><img src="curso_visualizacao_files/figure-html/unnamed-chunk-82-1.png" width="672" /></p>
<p>Semelhantemente a um histograma, as <em>aesthetics</em> <code>color</code> e <code>fill</code> podem ser definidas, sendo a primeira para a borda e a segunda para o corpo da curva de densidade:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df_feliz <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> healthy_life_expectancy_at_birth)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_density</span>(<span class="dt">color =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;green&quot;</span>)</code></pre></div>
<p><img src="curso_visualizacao_files/figure-html/unnamed-chunk-83-1.png" width="672" /></p>
<p>O gráfico de densidade, por si só, não oferece muito mais em termos de interpretabilidade que um histograma. Seu grande triunfo está em observar como se comporta a distribuição da variável contínua definida na <em>aesthetic</em> x em diferentes grupos de uma variável categórica definida na <em>aesthetic</em> fill:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df_feliz <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="co"># remover oceania porque so tem dois paises</span>
<span class="st">  </span><span class="kw">filter</span>(continent <span class="op">!=</span><span class="st"> &quot;Oceania&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> healthy_life_expectancy_at_birth)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_density</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> continent),
               <span class="co"># adicionar transparencia</span>
               <span class="dt">alpha =</span> <span class="fl">0.5</span>
               )</code></pre></div>
<p><img src="curso_visualizacao_files/figure-html/unnamed-chunk-84-1.png" width="672" /></p>
<p>A partir do gráfico de densidade acima, aprendemos algumas informações sobre nossos dados, como:<br />
* Não só a média da expectativa de vida da África é bem menor que a dos demais continentes, mas poucos países apresentam níveis dessa variável semelhantes a Europa, Asia e Americas.<br />
* Nenhuma das distribuições da variáveis nos quatro continentes aparenta ser normal: a da Europa, por exemplo, apresenta um formato bimodal. Essa pode ser uma informação importante para suas análises.</p>
<div class="alert alert-info" <strong="">
<p>Referências:</strong> <br> <a href="http://www.portalaction.com.br/probabilidades/62-distribuicao-normal">Distribuição normal</a><br />
<a href="https://ggplot2.tidyverse.org/reference/geom_density.html"><code>geom_density()</code></a></p>
</div>
</div>
<div id="boxplot" class="section level3">
<h3><span class="header-section-number">3.3.3</span> Boxplot</h3>
<p>Boxplot, ou diagramas de caixa, é uma outra maneira de estudar o comportamento de uma variável contínua segmentada por diferentes grupos de uma variável categórica. A função <code>geom_boxplot()</code> precisa de duas <code>aesthetics</code>: x, a variavel categórica, e y, a variável contínua:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df_feliz <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="co"># remover oceania porque so tem dois paises</span>
<span class="st">  </span><span class="kw">filter</span>(continent <span class="op">!=</span><span class="st"> &quot;Oceania&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> continent, <span class="dt">y =</span> healthy_life_expectancy_at_birth)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_boxplot</span>()</code></pre></div>
<p><img src="curso_visualizacao_files/figure-html/unnamed-chunk-85-1.png" width="672" /></p>
<p>Um boxplot tenta resumir uma variável numérica usando 5 números: a mediana (linha central da caixa), o primeiro quartil ou 25% percentil (linha inferior), o terceiro quartil ou 75% percentil (linha superior) e uma margem definida pelos intervalos interquartis multiplicados por um fator, que por padrão é 1,58. Ou seja: <span class="math inline">\(1.58 \times IQR\)</span>. Pontos fora desses limites seriam considerados outliers ou anomalias para aquele grupo.</p>
<p>Em determinadas situações, é desejável inverter os eixos, transformando o gráfico em horizontal. Isso é possível por meio da função <code>coord_flip()</code></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df_feliz <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(continent <span class="op">!=</span><span class="st"> &quot;Oceania&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> continent, <span class="dt">y =</span> healthy_life_expectancy_at_birth)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_boxplot</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">coord_flip</span>()</code></pre></div>
<p><img src="curso_visualizacao_files/figure-html/unnamed-chunk-86-1.png" width="672" /></p>
<p>Também é possível criar uma subdivisão com boxplots usando o argumento fill. Por exemplo:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># criar nova variavel que indica se um país possui um </span>
<span class="co"># indice de felicidade maior que 6</span>

df_feliz <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(continent <span class="op">!=</span><span class="st"> &quot;Oceania&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">indice_felicidade =</span> <span class="kw">if_else</span>(life_ladder <span class="op">&gt;</span><span class="st"> </span><span class="dv">6</span>,
                                     <span class="st">&quot;acima de 6&quot;</span>,
                                     <span class="st">&quot;abaixo&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> continent, <span class="dt">y =</span> healthy_life_expectancy_at_birth)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_boxplot</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> indice_felicidade))</code></pre></div>
<p><img src="curso_visualizacao_files/figure-html/unnamed-chunk-87-1.png" width="672" /></p>
<p>Assim, com o gráfico acima descobrimos que países dentro de um mesmo continente que possuem índice de felicidade acima 6 possuem também maior expectativa de vida, o que era esperado. Nota-se que a caixa dos países da África com índice de felicidade acima de 6 ficou achatada porque só tem um país.</p>
<div class="alert alert-info" <strong="">
<p>Referências:</strong> <a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html"><code>geom_boxplot()</code></a></p>
</div>
</div>
<div id="jitter" class="section level3">
<h3><span class="header-section-number">3.3.4</span> Jitter</h3>
<p>Uma maneira de incrementar um boxplot é plotar também todos os pontos, e não apenas os 5 que o boxplot representa. Isso pode ser feito com a função <code>geom_jitter()</code>, que é uma variação de <code>geom_point()</code> que adiciona uma pequena quantidade de variação aleatória na posição dos pontos, o que pode ser útil ao plotar pontos que sobreporiam devido a grande quantidade de indíviduos presentes em um mesmo intervalo de pontos.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df_feliz <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="co"># remover oceania porque so tem dois paises</span>
<span class="st">  </span><span class="kw">filter</span>(continent <span class="op">!=</span><span class="st"> &quot;Oceania&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> continent, <span class="dt">y =</span> healthy_life_expectancy_at_birth)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_boxplot</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_jitter</span>(<span class="dt">color =</span> <span class="st">&quot;red&quot;</span>)</code></pre></div>
<p><img src="curso_visualizacao_files/figure-html/unnamed-chunk-88-1.png" width="672" /></p>
<p>Uma curiosidade interessante do <code>ggplot2</code> é que as camadas são criadas na ordem que são definidas. Observe a diferença do gráfico acima para o criado abaixo, onde a ordem das camadas de boxplot e jitter foi invertida:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df_feliz <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="co"># remover oceania porque so tem dois paises</span>
<span class="st">  </span><span class="kw">filter</span>(continent <span class="op">!=</span><span class="st"> &quot;Oceania&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> continent, <span class="dt">y =</span> healthy_life_expectancy_at_birth)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_jitter</span>(<span class="dt">color =</span> <span class="st">&quot;red&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_boxplot</span>() </code></pre></div>
<p><img src="curso_visualizacao_files/figure-html/unnamed-chunk-89-1.png" width="672" /></p>
<div class="alert alert-info" <strong="">
<p>Referências:</strong> <a href="https://ggplot2.tidyverse.org/reference/geom_jitter.html"><code>geom_jitter()</code></a></p>
</div>
</div>
</div>
<div id="graficos-de-series-temporais-linhas" class="section level2">
<h2><span class="header-section-number">3.4</span> Gráficos de séries temporais (linhas)</h2>
<p>Série temporal é definida como uma variável contínua mensurada em intervalos regulares de tempo. A melhor representação visual para dados desse tipo são gráficos de linha, que são úteis para mostrar o comportamento de uma variável ao longo do tempo.</p>
<p>Como exemplo para gráficos de linha, vamos plotar a evolução de dois importantes indicadores econômicos brasileiros: a taxa SELIC e o índice IPCA, ambos mensalizados. Para obter esses indicadores, usamos o pacote <code>rbcb</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Importar para o R dados das series.</span>
lista_datasets &lt;-<span class="st"> </span>rbcb<span class="op">::</span><span class="kw">get_series</span>(<span class="dt">code =</span> <span class="kw">c</span>(<span class="dt">ipca =</span> <span class="dv">433</span>, <span class="dt">selic =</span> <span class="dv">4390</span>))
<span class="co"># O objeto retornado é uma lista de dois dataframes:</span>
<span class="kw">str</span>(lista_datasets)</code></pre></div>
<pre><code>## List of 2
##  $ ipca :Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;:   463 obs. of  2 variables:
##   ..$ date: Date[1:463], format: &quot;1980-01-01&quot; ...
##   ..$ ipca: num [1:463] 6.62 4.62 6.04 5.29 5.7 5.31 5.55 4.95 4.23 9.48 ...
##  $ selic:Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;:   387 obs. of  2 variables:
##   ..$ date : Date[1:387], format: &quot;1986-06-01&quot; ...
##   ..$ selic: num [1:387] 1.27 1.95 2.57 2.94 1.96 ...</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Voce pode acessar cada dataframe usando a sintaxe NOME_DA_LISTA$NOME_DO_OBJETO:</span>
<span class="kw">str</span>(lista_datasets<span class="op">$</span>selic)</code></pre></div>
<pre><code>## Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;:    387 obs. of  2 variables:
##  $ date : Date, format: &quot;1986-06-01&quot; &quot;1986-07-01&quot; ...
##  $ selic: num  1.27 1.95 2.57 2.94 1.96 ...</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Vamos então criar apenas um dataset que corresponde a junção dos dois dataframes</span>
df_st &lt;-<span class="st"> </span><span class="kw">left_join</span>(lista_datasets<span class="op">$</span>ipca,
                   lista_datasets<span class="op">$</span>selic,
                   <span class="dt">by =</span> <span class="st">&quot;date&quot;</span>)

<span class="co"># conferindo o novo dataframe criado</span>
<span class="kw">head</span>(df_st)</code></pre></div>
<pre><code>## # A tibble: 6 x 3
##   date        ipca selic
##   &lt;date&gt;     &lt;dbl&gt; &lt;dbl&gt;
## 1 1980-01-01  6.62    NA
## 2 1980-02-01  4.62    NA
## 3 1980-03-01  6.04    NA
## 4 1980-04-01  5.29    NA
## 5 1980-05-01  5.7     NA
## 6 1980-06-01  5.31    NA</code></pre>
<p>Temos uma coluna de data (<code>date</code>), cuja classe é <code>Date</code> e será usada como eixo x no gráfico de séries temporais:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># grafico da taxa selic</span>
<span class="kw">ggplot</span>(df_st, <span class="kw">aes</span>(<span class="dt">x =</span> date, <span class="dt">y =</span> ipca)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_line</span>()</code></pre></div>
<p><img src="curso_visualizacao_files/figure-html/unnamed-chunk-91-1.png" width="672" /></p>
<p>Adicionar <code>geom_smooth(method = &quot;loess&quot;)</code> ajuda a distinguir movimentos de tendência na série temporal:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df_st <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(date <span class="op">&gt;=</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2008-01-01&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> date, <span class="dt">y =</span> selic)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;loess&quot;</span>, <span class="dt">se =</span> <span class="ot">FALSE</span>)</code></pre></div>
<p><img src="curso_visualizacao_files/figure-html/unnamed-chunk-92-1.png" width="672" /></p>
<p>É possível incluir no gráfico mais de uma variável no eixo y. Uma das alternativas é simplesmente acrescentar mais uma camada <code>geom_line()</code> com a nova variável:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(df_st, <span class="kw">aes</span>(<span class="dt">x =</span> date, <span class="dt">y =</span> ipca)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span>
<span class="st">  </span><span class="co"># adicionar mais uma camada de geom_line</span>
<span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">y =</span> selic), <span class="dt">color =</span> <span class="st">&quot;blue&quot;</span>)</code></pre></div>
<pre><code>## Warning: Removed 77 rows containing missing values (geom_path).</code></pre>
<p><img src="curso_visualizacao_files/figure-html/unnamed-chunk-93-1.png" width="672" /></p>
<p>No entanto, a melhor maneira de se fazer isso é converter os dados para o formato long (tidy):</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df_st_tidy &lt;-<span class="st"> </span>df_st <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">gather</span>(indicador, valor, ipca<span class="op">:</span>selic) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">arrange</span>(date)

<span class="kw">head</span>(df_st_tidy)</code></pre></div>
<pre><code>## # A tibble: 6 x 3
##   date       indicador valor
##   &lt;date&gt;     &lt;chr&gt;     &lt;dbl&gt;
## 1 1980-01-01 ipca       6.62
## 2 1980-01-01 selic     NA   
## 3 1980-02-01 ipca       4.62
## 4 1980-02-01 selic     NA   
## 5 1980-03-01 ipca       6.04
## 6 1980-03-01 selic     NA</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># antes de proceder com o restante do exercicio, vamos salvar o dataset para</span>
<span class="co"># o usar nos proximos modulos</span>
<span class="kw">write_rds</span>(df_st_tidy, <span class="st">&quot;series_ipca_selic.rds&quot;</span>)</code></pre></div>
<p>Note que <code>indicador</code> é uma coluna categórica e <code>valor</code>, numérica. Portanto, a primeira será mapeada à <em>aesthetic</em> <strong>y</strong> e a segunda a <strong>color</strong>. Agora, a variável <code>indicador</code> é mapeada ao atributo color.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df_st_tidy <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> date, <span class="dt">y =</span> valor, <span class="dt">color =</span> indicador)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_line</span>()</code></pre></div>
<pre><code>## Warning: Removed 77 rows containing missing values (geom_path).</code></pre>
<p><img src="curso_visualizacao_files/figure-html/unnamed-chunk-95-1.png" width="672" /></p>
<p>Notou como o período antes de 1995 representava uma realidade muito diferente da atual? Vamos então filtrar os dados a partir desse ano.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df_st_pos_<span class="dv">1995</span> &lt;-<span class="st"> </span>df_st_tidy <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(date <span class="op">&gt;=</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;1995-01-01&quot;</span>))

df_st_pos_<span class="dv">1995</span> <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> date, <span class="dt">y =</span> valor, <span class="dt">color =</span> indicador)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_line</span>()</code></pre></div>
<p><img src="curso_visualizacao_files/figure-html/unnamed-chunk-96-1.png" width="672" /></p>
<div class="alert alert-info" <strong="">
<p>Referências:</strong> <a href="https://ggplot2.tidyverse.org/reference/geom_path.html"><code>geom_line()</code></a></p>
</div>
</div>
<div id="mapas-de-calor" class="section level2">
<h2><span class="header-section-number">3.5</span> Mapas de calor</h2>
<p>Até agora, estudamos gráficos para representar as relações entre:<br />
* Uma variavél categórica com ou sem uma numérica (gráficos de barra)<br />
* Duas numéricas (gráficos de pontos)<br />
* Uma numérica (histogramas e boxplots)<br />
* Uma numérica ao longo do tempo (gráficos de linhas)</p>
<p>Para representar uma relação um pouco mais complexa, a de duas variáveis categóricas e uma numérica, pode-se usar um mapa de calor.</p>
<p>Suponha que você deseja plotar a correlação entre todos os possíveis pares de correlação das variáveis de um dataset:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># calcular correlacao entre as variaveis numericas do dataset de felicidade</span>
df_feliz_num &lt;-<span class="st"> </span>df_feliz <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">select</span>(life_ladder, log_gdp_per_capita, social_support,
         healthy_life_expectancy_at_birth, gini, perceptions_of_corruption) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="co"># removar NAs</span>
<span class="st">  </span><span class="kw">na.omit</span>()
<span class="co"># criar matriz de correlacao</span>
matriz_correl &lt;-<span class="st"> </span><span class="kw">cor</span>(df_feliz_num)
<span class="co"># de uma olhada no objeto criado</span>
<span class="co"># matriz_correl</span>

<span class="co"># transformar para dataframe</span>
matriz_correl &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(matriz_correl) 
<span class="co"># conveter rownames para uma coluna</span>
matriz_correl &lt;-<span class="st"> </span><span class="kw">rownames_to_column</span>(matriz_correl, <span class="st">&quot;var1&quot;</span>)
<span class="co"># converter dataframe para formato tidy</span>
matriz_correl_tidy &lt;-<span class="st"> </span>matriz_correl <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">gather</span>(var2, correlacao, <span class="op">-</span>var1)

<span class="kw">head</span>(matriz_correl_tidy)</code></pre></div>
<pre><code>##                               var1        var2 correlacao
## 1                      life_ladder life_ladder  1.0000000
## 2               log_gdp_per_capita life_ladder  0.7549421
## 3                   social_support life_ladder  0.7647823
## 4 healthy_life_expectancy_at_birth life_ladder  0.7304080
## 5                             gini life_ladder -0.4581271
## 6        perceptions_of_corruption life_ladder -0.5000318</code></pre>
<p>Assim, no dataframe <code>var1</code> e <code>var2</code>, temos duas variáveis categóricas (os pares de variáveis) e uma numérica (a correlação entre as duas variáveis).</p>
<p>A função do <code>ggplot2</code> para criar um mapa de calor é <code>geom_tile</code>, que precisa de três <em>aesthetics</em>: os eixos <strong>x</strong> e <strong>y</strong>, que são as variáveis categóricas, e <strong>fill</strong>, que será a variável contínua que definirá a cor dos quadrados:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">matriz_correl_tidy <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> var1, <span class="dt">y =</span> var2, <span class="dt">fill =</span> correlacao)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_tile</span>()</code></pre></div>
<p><img src="curso_visualizacao_files/figure-html/unnamed-chunk-98-1.png" width="672" /></p>
<p>Devido ao tamanho dos nomes das variáveis, o eixo x ficou difícil de ler. Uma solução é mudar o ângulo dos nomes, isto é, colocá-los na vertical. A função <code>theme()</code>, que ainda será mostrada em detalhes neste módulo, possui um argumento para fazer isso:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">matriz_correl_tidy <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> var1, <span class="dt">y =</span> var2, <span class="dt">fill =</span> correlacao)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_tile</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>))</code></pre></div>
<p><img src="curso_visualizacao_files/figure-html/unnamed-chunk-99-1.png" width="672" /></p>
<p>Caso você não tenha gostado da escala de cores em azul definida por padrão pelo ggplot2, é possível mudar usando a função scale_fill_distiller:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">matriz_correl_tidy <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> var1, <span class="dt">y =</span> var2, <span class="dt">fill =</span> correlacao)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_tile</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_fill_distiller</span>(
    <span class="co"># alterar o tipo da escala. pode ser divergente, sequencial e categorica</span>
    <span class="dt">type =</span> <span class="st">&quot;div&quot;</span>,
    <span class="co"># alterar a paleta. confira os possiveis valores na documentacao da funcao</span>
    <span class="dt">palette =</span> <span class="st">&quot;RdBu&quot;</span>,
    <span class="co"># inverter a direcao</span>
    <span class="dt">direction =</span> <span class="dv">1</span>
    ) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>))</code></pre></div>
<p><img src="curso_visualizacao_files/figure-html/unnamed-chunk-100-1.png" width="672" /></p>
<div class="alert alert-info" <strong="">
<p>Referências:</strong> <br> <a href="https://ggplot2.tidyverse.org/reference/geom_tile.html"><code>geom_tile()</code></a></p>
</div>
</div>
<div id="customizando-escalas" class="section level2">
<h2><span class="header-section-number">3.6</span> Customizando escalas</h2>
<p>Nem sempre os gráficos produzidos pelo <code>ggplot2</code> possuem, com a configuração padrão, aspectos visuais agradáveis. Um deles são os eixos do gráfico, tanto o horizontal como o vertical. No exemplo abaixo, usamos o dataset <code>txhousing</code>, que traz dados de vendas de imóveis no estado de Texas, nos EUA, ao longo do tempo.</p>
<p>Primeiramente, dado que existem colunas de ano e mês mas não de dia (visto que os dados estão agregados por mês), usamos a função <code>ISOdate()</code> para criar uma coluna de datas:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># exemplo da função ISOdate:</span>
<span class="kw">ISOdate</span>(<span class="dt">year =</span> <span class="dv">2011</span>, <span class="dt">month =</span> <span class="dv">11</span>, <span class="dt">day =</span> <span class="dv">22</span>)</code></pre></div>
<pre><code>## [1] &quot;2011-11-22 12:00:00 GMT&quot;</code></pre>
<p>Após a criação da coluna de data (<code>data_mes</code>), vamos plotar a distribuição do volume médio de vendas de imóveis por mês:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># importar dataset</span>
<span class="co"># consulte a documentação do dataset: </span>
<span class="co"># ?txhousing</span>
<span class="kw">data</span>(<span class="st">&quot;txhousing&quot;</span>)
  
<span class="co"># valor medio por ano</span>
txhousing <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">data_mes =</span> <span class="kw">as.Date</span>(<span class="kw">ISOdate</span>(<span class="dt">year =</span> year, <span class="dt">month =</span> month, <span class="dt">day =</span> <span class="dv">1</span>))) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">group_by</span>(data_mes) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">summarise</span>(<span class="dt">volume_medio =</span> <span class="kw">mean</span>(volume, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> data_mes, <span class="dt">y =</span> volume_medio)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_line</span>()</code></pre></div>
<p><img src="curso_visualizacao_files/figure-html/unnamed-chunk-102-1.png" width="672" /></p>
<p>Existem dois problemas relacionados aos eixos no gráfico acima:<br />
* Os intervalos do eixo horizontal (x) são de 5 anos (2000, 2005, 2010 e 2015), o que não facilita o percebimento dos componentes sazonais dentro de um ano.<br />
* O eixo vertical (y) foi convertido para a notação científica devido ao tamanho dos números, o que é geralmente indesejável.</p>
<p>Qualquer alteração relacionada aos eixos pode ser feita com as funções da família <code>scale_EIXO_CLASSE</code>, sendo algumas das principais:</p>
<ul>
<li><code>scale_x_date()</code> e <code>scale_y_date()</code></li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">scale_x_date</span>(<span class="dt">name =</span> <span class="kw">waiver</span>(), <span class="dt">breaks =</span> <span class="kw">waiver</span>(),
             <span class="dt">date_breaks =</span> <span class="kw">waiver</span>(), <span class="dt">labels =</span> <span class="kw">waiver</span>(),
             <span class="dt">date_labels =</span> <span class="kw">waiver</span>(), <span class="dt">minor_breaks =</span> <span class="kw">waiver</span>(),
             <span class="dt">date_minor_breaks =</span> <span class="kw">waiver</span>(), <span class="dt">limits =</span> <span class="ot">NULL</span>,
             <span class="dt">expand =</span> <span class="kw">waiver</span>(), <span class="dt">position =</span> <span class="st">&quot;bottom&quot;</span>)</code></pre></div>
<pre><code>## &lt;ScaleContinuousDate&gt;
##  Range:  
##  Limits:    0 --    1</code></pre>
<ul>
<li><code>scale_x_continuous()</code> e <code>scale_y_continuous()</code></li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">scale_x_continuous</span>(<span class="dt">name =</span> <span class="kw">waiver</span>(), <span class="dt">breaks =</span> <span class="kw">waiver</span>(),
                   <span class="dt">minor_breaks =</span> <span class="kw">waiver</span>(), <span class="dt">labels =</span> <span class="kw">waiver</span>(),
                   <span class="dt">limits =</span> <span class="ot">NULL</span>, <span class="dt">expand =</span> <span class="kw">waiver</span>(),
                   <span class="dt">oob =</span> censor, <span class="dt">na.value =</span> <span class="ot">NA_real_</span>,
                   <span class="dt">trans =</span> <span class="st">&quot;identity&quot;</span>, <span class="dt">position =</span> <span class="st">&quot;bottom&quot;</span>,
                   <span class="dt">sec.axis =</span> <span class="kw">waiver</span>())</code></pre></div>
<ul>
<li><code>scale_x_discrete()</code> e <code>scale_x_discrete()</code></li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">scale_x_discrete</span>(..., <span class="dt">expand =</span> <span class="kw">waiver</span>(), <span class="dt">position =</span> <span class="st">&quot;bottom&quot;</span>)</code></pre></div>
<p>Para customizar a escala do eixo horizontal, por exemplo, podemos usar <code>scale_x_date()</code> e dois argumentos: <code>date_breaks()</code> para especificar que os eixos serão quebrados em intervalos de 1 ano e <code>date_labels()</code> para mostrar apenas o ano da data:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">txhousing <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">data_mes =</span> <span class="kw">as.Date</span>(<span class="kw">ISOdate</span>(<span class="dt">year =</span> year, <span class="dt">month =</span> month, <span class="dt">day =</span> <span class="dv">1</span>))) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">group_by</span>(data_mes) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">summarise</span>(<span class="dt">volume_medio =</span> <span class="kw">mean</span>(volume, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> data_mes, <span class="dt">y =</span> volume_medio)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_date</span>(<span class="dt">date_breaks =</span> <span class="st">&quot;1 year&quot;</span>,
               <span class="dt">date_labels =</span> <span class="st">&quot;%Y&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="co"># remover os minor grids do eixo x.</span>
<span class="st">  </span><span class="co"># mais detalhes sobre a função theme() no módulo 3</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid.minor.x =</span> <span class="kw">element_blank</span>())</code></pre></div>
<p>Com essa alteração, ficou mais perceptível o componente sazonal nos dados: as vendas de imóveis tendem a ser maiores no meio do ano.</p>
<p>Para resolver o aspecto visual do eixo vertical, usamos a função <code>scale_y_continuous()</code>, visto que a variável mapeada ao eixo y é contínua, para definir o parâmetro <code>labels</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">txhousing <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">data_mes =</span> <span class="kw">as.Date</span>(<span class="kw">ISOdate</span>(<span class="dt">year =</span> year, <span class="dt">month =</span> month, <span class="dt">day =</span> <span class="dv">1</span>))) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">group_by</span>(data_mes) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">summarise</span>(<span class="dt">volume_medio =</span> <span class="kw">mean</span>(volume, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> data_mes, <span class="dt">y =</span> volume_medio)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_date</span>(<span class="dt">date_breaks =</span> <span class="st">&quot;1 year&quot;</span>,
               <span class="dt">date_labels =</span> <span class="st">&quot;%Y&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="co"># ajustar o eixo y</span>
<span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">labels =</span> scales<span class="op">::</span><span class="kw">number_format</span>(<span class="dt">big.mark =</span> <span class="st">&quot;.&quot;</span>,
                                                    <span class="dt">decimal.mark =</span> <span class="st">&quot;,&quot;</span>)) <span class="op">+</span>
<span class="st">  </span><span class="co"># remover os minor grids do eixo x.</span>
<span class="st">  </span><span class="co"># mais detalhes sobre a função theme() no módulo 3</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid.minor.x =</span> <span class="kw">element_blank</span>())</code></pre></div>
<p><img src="curso_visualizacao_files/figure-html/unnamed-chunk-107-1.png" width="672" /></p>
<p>Na verdade, seria mais simples ajustar a escala da própria variável, sem usar <code>scale_y_continuous()</code>, mas apenas a dividindo por 1 milhão e informando tal transformação no título do eixo:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">txhousing <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">data_mes =</span> <span class="kw">as.Date</span>(<span class="kw">ISOdate</span>(<span class="dt">year =</span> year, <span class="dt">month =</span> month, <span class="dt">day =</span> <span class="dv">1</span>))) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">group_by</span>(data_mes) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">summarise</span>(<span class="dt">volume_medio =</span> <span class="kw">mean</span>(volume, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="co"># dividir volume_medio por 1 milhao</span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> data_mes, <span class="dt">y =</span> volume_medio<span class="op">/</span><span class="fl">1e6</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_date</span>(<span class="dt">date_breaks =</span> <span class="st">&quot;1 year&quot;</span>,
               <span class="dt">date_labels =</span> <span class="st">&quot;%Y&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="co"># remover os minor grids do eixo x.</span>
<span class="st">  </span><span class="co"># mais detalhes sobre a função theme() no módulo 3</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid.minor.x =</span> <span class="kw">element_blank</span>()) <span class="op">+</span>
<span class="st">  </span><span class="co"># mudar titulo do eixo y</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="st">&quot;Volume médio (Milhões)&quot;</span>)</code></pre></div>
<p><img src="curso_visualizacao_files/figure-html/unnamed-chunk-108-1.png" width="672" /></p>
<p>Existe uma infinidade de customizações que podem ser feitas a partir das funções dessa família. Veja quantas existem no total:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># conjunto de todas as funcoes do ggplot2</span>
funcoes_gg &lt;-<span class="st"> </span><span class="kw">ls</span>(<span class="st">&quot;package:ggplot2&quot;</span>)
<span class="co">#funcoes da famlia scale_:</span>
<span class="kw">str_subset</span>(funcoes_gg, <span class="st">&quot;scale_&quot;</span>)</code></pre></div>
<pre><code>##  [1] &quot;scale_alpha&quot;               &quot;scale_alpha_continuous&quot;   
##  [3] &quot;scale_alpha_date&quot;          &quot;scale_alpha_datetime&quot;     
##  [5] &quot;scale_alpha_discrete&quot;      &quot;scale_alpha_identity&quot;     
##  [7] &quot;scale_alpha_manual&quot;        &quot;scale_alpha_ordinal&quot;      
##  [9] &quot;scale_color_brewer&quot;        &quot;scale_color_continuous&quot;   
## [11] &quot;scale_color_discrete&quot;      &quot;scale_color_distiller&quot;    
## [13] &quot;scale_color_gradient&quot;      &quot;scale_color_gradient2&quot;    
## [15] &quot;scale_color_gradientn&quot;     &quot;scale_color_grey&quot;         
## [17] &quot;scale_color_hue&quot;           &quot;scale_color_identity&quot;     
## [19] &quot;scale_color_manual&quot;        &quot;scale_color_viridis_c&quot;    
## [21] &quot;scale_color_viridis_d&quot;     &quot;scale_colour_brewer&quot;      
## [23] &quot;scale_colour_continuous&quot;   &quot;scale_colour_date&quot;        
## [25] &quot;scale_colour_datetime&quot;     &quot;scale_colour_discrete&quot;    
## [27] &quot;scale_colour_distiller&quot;    &quot;scale_colour_gradient&quot;    
## [29] &quot;scale_colour_gradient2&quot;    &quot;scale_colour_gradientn&quot;   
## [31] &quot;scale_colour_grey&quot;         &quot;scale_colour_hue&quot;         
## [33] &quot;scale_colour_identity&quot;     &quot;scale_colour_manual&quot;      
## [35] &quot;scale_colour_ordinal&quot;      &quot;scale_colour_viridis_c&quot;   
## [37] &quot;scale_colour_viridis_d&quot;    &quot;scale_continuous_identity&quot;
## [39] &quot;scale_discrete_identity&quot;   &quot;scale_discrete_manual&quot;    
## [41] &quot;scale_fill_brewer&quot;         &quot;scale_fill_continuous&quot;    
## [43] &quot;scale_fill_date&quot;           &quot;scale_fill_datetime&quot;      
## [45] &quot;scale_fill_discrete&quot;       &quot;scale_fill_distiller&quot;     
## [47] &quot;scale_fill_gradient&quot;       &quot;scale_fill_gradient2&quot;     
## [49] &quot;scale_fill_gradientn&quot;      &quot;scale_fill_grey&quot;          
## [51] &quot;scale_fill_hue&quot;            &quot;scale_fill_identity&quot;      
## [53] &quot;scale_fill_manual&quot;         &quot;scale_fill_ordinal&quot;       
## [55] &quot;scale_fill_viridis_c&quot;      &quot;scale_fill_viridis_d&quot;     
## [57] &quot;scale_linetype&quot;            &quot;scale_linetype_continuous&quot;
## [59] &quot;scale_linetype_discrete&quot;   &quot;scale_linetype_identity&quot;  
## [61] &quot;scale_linetype_manual&quot;     &quot;scale_radius&quot;             
## [63] &quot;scale_shape&quot;               &quot;scale_shape_continuous&quot;   
## [65] &quot;scale_shape_discrete&quot;      &quot;scale_shape_identity&quot;     
## [67] &quot;scale_shape_manual&quot;        &quot;scale_shape_ordinal&quot;      
## [69] &quot;scale_size&quot;                &quot;scale_size_area&quot;          
## [71] &quot;scale_size_continuous&quot;     &quot;scale_size_date&quot;          
## [73] &quot;scale_size_datetime&quot;       &quot;scale_size_discrete&quot;      
## [75] &quot;scale_size_identity&quot;       &quot;scale_size_manual&quot;        
## [77] &quot;scale_size_ordinal&quot;        &quot;scale_type&quot;               
## [79] &quot;scale_x_continuous&quot;        &quot;scale_x_date&quot;             
## [81] &quot;scale_x_datetime&quot;          &quot;scale_x_discrete&quot;         
## [83] &quot;scale_x_log10&quot;             &quot;scale_x_reverse&quot;          
## [85] &quot;scale_x_sqrt&quot;              &quot;scale_x_time&quot;             
## [87] &quot;scale_y_continuous&quot;        &quot;scale_y_date&quot;             
## [89] &quot;scale_y_datetime&quot;          &quot;scale_y_discrete&quot;         
## [91] &quot;scale_y_log10&quot;             &quot;scale_y_reverse&quot;          
## [93] &quot;scale_y_sqrt&quot;              &quot;scale_y_time&quot;</code></pre>
<div class="alert alert-info" <strong="">
<p>Referências:</strong> <br> <a href="https://cdr.ibpad.com.br/ggplot2.html#escalas">Material sobre funções da família scale</a>, seção 9.3.</p>
</div>
</div>
<div id="texto" class="section level2">
<h2><span class="header-section-number">3.7</span> Texto</h2>
<p>As funções <code>geom_text()</code> e <code>geom_label()</code> servem para acrescentar camadas de texto no gráfico. A única diferença entre as duas é que <code>geom_label()</code> desenha um retângulo no fundo do texto, possivelmente melhorando sua leitura. Ambas funções <code>geom_text()</code> dependem de três <em>aesthetics</em>: <strong>x</strong> e <strong>y</strong>, que correspondem às posições dos textos a serem plotados, e <strong>label</strong>, que é o texto a ser plotado.</p>
<p>No exemplo abaixo, não especificamos <strong>x</strong> e <strong>y</strong> em <code>geom_text()</code> porque a função herda as definidas na função <code>ggplot()</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># agrupar os dados e contar a quantidade de países por continente</span>
df_feliz_agg &lt;-<span class="st"> </span>df_feliz <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">group_by</span>(continent) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">summarise</span>(<span class="dt">qtd_paises =</span> <span class="kw">n</span>())

df_feliz_agg</code></pre></div>
<pre><code>## # A tibble: 5 x 2
##   continent qtd_paises
##   &lt;chr&gt;          &lt;int&gt;
## 1 Africa            38
## 2 Americas          20
## 3 Asia              41
## 4 Europe            40
## 5 Oceania            2</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df_feliz_agg <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> continent, <span class="dt">y =</span> qtd_paises)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_col</span>() <span class="op">+</span>
<span class="st">  </span><span class="co"># adicionar camada de texto</span>
<span class="st">  </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(<span class="dt">label =</span> qtd_paises))</code></pre></div>
<p><img src="curso_visualizacao_files/figure-html/unnamed-chunk-111-1.png" width="672" /></p>
<p>Observe a diferença de <code>geom_label()</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df_feliz_agg <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> continent, <span class="dt">y =</span> qtd_paises)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_col</span>() <span class="op">+</span>
<span class="st">  </span><span class="co"># adicionar camada de texto</span>
<span class="st">  </span><span class="kw">geom_label</span>(<span class="kw">aes</span>(<span class="dt">label =</span> qtd_paises))</code></pre></div>
<p><img src="curso_visualizacao_files/figure-html/unnamed-chunk-112-1.png" width="672" /></p>
<p>É possível alterar a posição da camada de texto no gráfico alterando os argumentos <code>vjust</code> e <code>hjust</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df_feliz_agg <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> continent, <span class="dt">y =</span> qtd_paises)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_col</span>() <span class="op">+</span>
<span class="st">  </span><span class="co"># adicionar camada de texto</span>
<span class="st">  </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(<span class="dt">label =</span> qtd_paises),
            <span class="co"># mudar posicao para mais baixo</span>
            <span class="dt">vjust =</span> <span class="dv">1</span>,
            <span class="co"># mudar posicao para mais a direita</span>
            <span class="dt">hjust =</span> <span class="op">-</span><span class="dv">1</span>,
            <span class="co"># porque nao, alterar tambem a cor</span>
            <span class="dt">color =</span> <span class="st">&quot;white&quot;</span>
            )</code></pre></div>
<p><img src="curso_visualizacao_files/figure-html/unnamed-chunk-113-1.png" width="672" /></p>
<p>Suponha que no primeiro gráfico de pontos mostrado no material, que mostra a relação entre PIB per capita e expectativa de vida, você deseja também acrescentar os nomes dos países:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df_feliz <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> log_gdp_per_capita,
             <span class="dt">y =</span> healthy_life_expectancy_at_birth)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(<span class="dt">label =</span> country))</code></pre></div>
<pre><code>## Warning: Removed 7 rows containing missing values (geom_point).</code></pre>
<pre><code>## Warning: Removed 7 rows containing missing values (geom_text).</code></pre>
<p><img src="curso_visualizacao_files/figure-html/unnamed-chunk-114-1.png" width="672" /></p>
<p>Como era de se esperar, o gráfico ficou muito poluído. Vamos então reduzir os pontos que queremos mostrar os nomes dos respectivos países apenas aos países dos continentes americanos. A estrategia, então, consiste em criar um novo dataframe com esses países e mudar o argumento <code>data</code> em geom_text:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">america &lt;-<span class="st"> </span>df_feliz <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(continent <span class="op">==</span><span class="st"> &quot;Americas&quot;</span>)

df_feliz <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> log_gdp_per_capita,
             <span class="dt">y =</span> healthy_life_expectancy_at_birth)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_text</span>(<span class="dt">data =</span> america, <span class="kw">aes</span>(<span class="dt">label =</span> country))</code></pre></div>
<pre><code>## Warning: Removed 7 rows containing missing values (geom_point).</code></pre>
<p><img src="curso_visualizacao_files/figure-html/unnamed-chunk-115-1.png" width="672" /></p>
<p>Melhorou, mas ainda assim ficou poluído. Uma boa solução para esse problema é o pacote <code>ggrepel</code>, que internamente calcula a melhor posição entre os pontos da camada de texto, seja <code>geom_text()</code> ou <code>geom_label()</code>, de forma que não haja conflito de posição entre pontos. A única alteração necessária é mudar <code>geom_text</code> para <code>geom_text_repel</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df_feliz <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> log_gdp_per_capita,
             <span class="dt">y =</span> healthy_life_expectancy_at_birth)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_text_repel</span>(<span class="dt">data =</span> america, <span class="kw">aes</span>(<span class="dt">label =</span> country))</code></pre></div>
<pre><code>## Warning: Removed 7 rows containing missing values (geom_point).</code></pre>
<p><img src="curso_visualizacao_files/figure-html/unnamed-chunk-116-1.png" width="672" /></p>
<p>Outro gráfico mostrado anteriormente neste material que pode ser melhorado é o mapa de calor, acrescentando uma camada de texto que mostre o valor numérico da correlação entre as variáveis:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">matriz_correl_tidy <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> var1, <span class="dt">y =</span> var2, <span class="dt">fill =</span> correlacao)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_tile</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_fill_distiller</span>(
    <span class="co"># alterar o tipo da escala. pode ser divergente, sequencial e categorica</span>
    <span class="dt">type =</span> <span class="st">&quot;div&quot;</span>,
    <span class="co"># alterar a paleta. confira os possiveis valores na documentacao da funcao</span>
    <span class="dt">palette =</span> <span class="st">&quot;RdBu&quot;</span>,
    <span class="co"># inverter a direcao</span>
    <span class="dt">direction =</span> <span class="dv">1</span>
    ) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>)) <span class="op">+</span>
<span class="st">  </span><span class="co"># adicionar camada de texto. é recomendável arredondar os numeros</span>
<span class="st">  </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(<span class="dt">label =</span> <span class="kw">round</span>(correlacao, <span class="dv">2</span>)))</code></pre></div>
<p><img src="curso_visualizacao_files/figure-html/unnamed-chunk-117-1.png" width="672" /></p>
<p><code>geom_text()</code> e <code>geom_label()</code> também podem ser usadas de maneira mais individualizada, ou seja, para adicionar anotações textuais em partes específicas do gráfico definidas pelo usuário. Observe o gráfico abaixo:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p2 &lt;-<span class="st"> </span>df_st <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(date <span class="op">&gt;=</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2016-01-01&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> date, <span class="dt">y =</span> selic)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_line</span>()<span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="co"># quebrar o eixo x a cada 3 meses</span>
<span class="st">  </span><span class="kw">scale_x_date</span>(
    <span class="dt">date_breaks =</span> <span class="st">&quot;2 month&quot;</span>,
    <span class="co"># mostrar eixos no formato mes/ano</span>
    <span class="dt">date_labels =</span> <span class="st">&quot;%m/%y&quot;</span>
  ) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">theme_minimal</span>()
<span class="co"># grafico sem anotação:</span>
p2</code></pre></div>
<p><img src="curso_visualizacao_files/figure-html/unnamed-chunk-118-1.png" width="672" /></p>
<p>A taxa Selic caiu bastante em 2017. Que tal acrescentar esse comentário na área do gráfico? Isso pode ser definindo definindo manualmente as <em>aesthetics</em> de <code>geom_text()</code> ou <code>geom_label()</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p2 <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_label</span>(
    <span class="dt">x =</span> <span class="kw">as.Date</span>(<span class="st">&quot;2018-02-01&quot;</span>),
    <span class="dt">y =</span> <span class="dv">1</span>,
    <span class="co"># Usamos o caracter especial \n para adicionar uma quebra de linha</span>
    <span class="dt">label =</span> <span class="st">&quot;A taxa SELIC apresentou </span><span class="ch">\n</span><span class="st">tendência de queda em 2017&quot;</span>
  )</code></pre></div>
<p><img src="curso_visualizacao_files/figure-html/unnamed-chunk-119-1.png" width="672" /></p>
<div class="alert alert-info" <strong="">
<p>Referências:</strong> <br> <a href="https://ggplot2.tidyverse.org/reference/geom_text.html"><code>geom_text()</code> e <code>geom_label()</code></a></p>
</div>
</div>
<div id="areas-ou-faixas-sombreadas" class="section level2">
<h2><span class="header-section-number">3.8</span> Áreas ou faixas sombreadas</h2>
<p>A função <code>geom_rect</code> pode ser usada para criar faixas sombreadas para destacar alguma parte específica do gráfico.</p>
<ul>
<li>No gráfico anterior, destacar o ano de 2017 no gráfico usando uma área sombreada:</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p2 <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_rect</span>(
    <span class="dt">xmin =</span> <span class="kw">as.Date</span>(<span class="st">&quot;2017-01-01&quot;</span>),
    <span class="dt">xmax =</span> <span class="kw">as.Date</span>(<span class="st">&quot;2017-12-01&quot;</span>),
    <span class="dt">ymin =</span> <span class="op">-</span><span class="ot">Inf</span>,
    <span class="dt">ymax =</span> <span class="ot">Inf</span>,
    <span class="co"># deixar o retangulo mais transparente</span>
    <span class="dt">alpha =</span> <span class="fl">0.01</span>
  )</code></pre></div>
<p><img src="curso_visualizacao_files/figure-html/unnamed-chunk-120-1.png" width="672" /></p>
<ul>
<li>Destacar uma faixa numérica relativa ao eixo y de interesse:</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p2 <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_rect</span>(
    <span class="co"># a geom rect precisa de 4 aesthetics:</span>
    <span class="dt">xmin =</span> <span class="op">-</span><span class="ot">Inf</span>,
    <span class="dt">xmax =</span> <span class="ot">Inf</span>,
    <span class="dt">ymin =</span> <span class="fl">0.6</span>,
    <span class="dt">ymax =</span> <span class="fl">0.8</span>,
    <span class="co"># mudar cor do retangulo para vermelho</span>
    <span class="dt">fill =</span> <span class="st">&quot;red&quot;</span>,
    <span class="co"># deixar a area sombreada mais transparente</span>
    <span class="dt">alpha =</span> <span class="fl">0.01</span>
  )</code></pre></div>
<p><img src="curso_visualizacao_files/figure-html/unnamed-chunk-121-1.png" width="672" /></p>
<p>Outra maneira de criar faixas sombreadas, desta vez dependendo do valor de uma variável, é usando a função <code>geom_ribbon()</code>. No exemplo da série acima, suponha que queiramos destacar uma faixa em torno da taxa Selic:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p2 <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> <span class="op">-</span><span class="fl">0.1</span> <span class="op">+</span><span class="st"> </span>selic, <span class="dt">ymax =</span> <span class="fl">0.1</span> <span class="op">+</span><span class="st"> </span>selic),
              <span class="dt">fill =</span> <span class="st">&quot;grey&quot;</span>, <span class="dt">alpha =</span> <span class="fl">0.4</span>)</code></pre></div>
<p><img src="curso_visualizacao_files/figure-html/unnamed-chunk-122-1.png" width="672" /></p>
</div>
<div id="alterando-aspectos-visuais-do-grafico-com-os-temas" class="section level2">
<h2><span class="header-section-number">3.9</span> Alterando aspectos visuais do gráfico com os temas</h2>
<p>Um tema, no <code>ggplot2</code>, é definido como um conjunto de propriedades visuais, como fonte, cor do painel de fundo, posição da legenda, etc.</p>
<p>O tema padrão do <code>ggplot2</code>, caracterizado principalmente pelo fundo cinza, pode ser mudado para temas pré-definidos no pacote:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># grafico padrao a ser modificado</span>
p &lt;-<span class="st"> </span>df_feliz <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> log_gdp_per_capita,
             <span class="dt">y =</span> healthy_life_expectancy_at_birth)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">color =</span> continent)) <span class="op">+</span>
<span class="st">  </span><span class="kw">facet_grid</span>(<span class="op">~</span><span class="st"> </span>continent)

p</code></pre></div>
<pre><code>## Warning: Removed 7 rows containing missing values (geom_point).</code></pre>
<p><img src="curso_visualizacao_files/figure-html/unnamed-chunk-123-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># usar tema bw:</span>
p <span class="op">+</span><span class="st"> </span><span class="kw">theme_bw</span>()</code></pre></div>
<pre><code>## Warning: Removed 7 rows containing missing values (geom_point).</code></pre>
<p><img src="curso_visualizacao_files/figure-html/unnamed-chunk-124-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># usar tema minimal:</span>
p <span class="op">+</span><span class="st"> </span><span class="kw">theme_minimal</span>()</code></pre></div>
<pre><code>## Warning: Removed 7 rows containing missing values (geom_point).</code></pre>
<p><img src="curso_visualizacao_files/figure-html/unnamed-chunk-124-2.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># tema classico</span>
p <span class="op">+</span><span class="st"> </span><span class="kw">theme_classic</span>()</code></pre></div>
<pre><code>## Warning: Removed 7 rows containing missing values (geom_point).</code></pre>
<p><img src="curso_visualizacao_files/figure-html/unnamed-chunk-124-3.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># tema dark</span>
p <span class="op">+</span><span class="st"> </span><span class="kw">theme_dark</span>()</code></pre></div>
<pre><code>## Warning: Removed 7 rows containing missing values (geom_point).</code></pre>
<p><img src="curso_visualizacao_files/figure-html/unnamed-chunk-124-4.png" width="672" /></p>
<p>Contudo, caso você não deseje usar o tema padrão mas mesmo assim quer alterar algumas propriedades visuais do gráfico, deve-se usar a função <code>theme()</code>. Esta é alista de todas as possíveis propriedades que podem ser alteradas:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">args</span>(theme)</code></pre></div>
<pre><code>## function (line, rect, text, title, aspect.ratio, axis.title, 
##     axis.title.x, axis.title.x.top, axis.title.x.bottom, axis.title.y, 
##     axis.title.y.left, axis.title.y.right, axis.text, axis.text.x, 
##     axis.text.x.top, axis.text.x.bottom, axis.text.y, axis.text.y.left, 
##     axis.text.y.right, axis.ticks, axis.ticks.x, axis.ticks.x.top, 
##     axis.ticks.x.bottom, axis.ticks.y, axis.ticks.y.left, axis.ticks.y.right, 
##     axis.ticks.length, axis.line, axis.line.x, axis.line.x.top, 
##     axis.line.x.bottom, axis.line.y, axis.line.y.left, axis.line.y.right, 
##     legend.background, legend.margin, legend.spacing, legend.spacing.x, 
##     legend.spacing.y, legend.key, legend.key.size, legend.key.height, 
##     legend.key.width, legend.text, legend.text.align, legend.title, 
##     legend.title.align, legend.position, legend.direction, legend.justification, 
##     legend.box, legend.box.just, legend.box.margin, legend.box.background, 
##     legend.box.spacing, panel.background, panel.border, panel.spacing, 
##     panel.spacing.x, panel.spacing.y, panel.grid, panel.grid.major, 
##     panel.grid.minor, panel.grid.major.x, panel.grid.major.y, 
##     panel.grid.minor.x, panel.grid.minor.y, panel.ontop, plot.background, 
##     plot.title, plot.subtitle, plot.caption, plot.tag, plot.tag.position, 
##     plot.margin, strip.background, strip.background.x, strip.background.y, 
##     strip.placement, strip.text, strip.text.x, strip.text.y, 
##     strip.switch.pad.grid, strip.switch.pad.wrap, ..., complete = FALSE, 
##     validate = TRUE) 
## NULL</code></pre>
<p>Como você percebeu, a lista é imensa. Por isso, vamos nos restringir neste material a alguns exemplos do que pode ser feito:</p>
<ul>
<li>Alterar a posição da legenda:</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;bottom&quot;</span>)</code></pre></div>
<pre><code>## Warning: Removed 7 rows containing missing values (geom_point).</code></pre>
<p><img src="curso_visualizacao_files/figure-html/unnamed-chunk-126-1.png" width="672" /></p>
<ul>
<li>Remover os minor grids de um eixo:</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="co"># remover minor grids do eixo x</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid.minor.y =</span> <span class="kw">element_blank</span>())</code></pre></div>
<pre><code>## Warning: Removed 7 rows containing missing values (geom_point).</code></pre>
<p><img src="curso_visualizacao_files/figure-html/unnamed-chunk-127-1.png" width="672" /></p>
<ul>
<li>Mudar cor de fundo:</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;azure&quot;</span>))</code></pre></div>
<pre><code>## Warning: Removed 7 rows containing missing values (geom_point).</code></pre>
<p><img src="curso_visualizacao_files/figure-html/unnamed-chunk-128-1.png" width="672" /></p>
<div class="alert alert-info" <strong="">
<p>Referências:</strong> <br> Confira todos os <a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">temas pré-definidos</a> do ggplot2<br />
<a href="https://ggplot2.tidyverse.org/reference/theme.html"><code>theme()</code></a></p>
</div>
<p>Uma das grandes vantagens do <code>ggplot2</code> é que basicamente tudo no gráfico é customizável. A função <code>theme</code> é usada para modificar componentes individuais de um tema</p>
</div>
<div id="titulos" class="section level2">
<h2><span class="header-section-number">3.10</span> Títulos</h2>
<p>Os títulos de todos os elementos de um gráfico, como os dos eixos, das legendas, do próprio título do gráfico, etc., podem ser alterados usando a função <code>labs()</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Log da PIB per capita&quot;</span>,
       <span class="dt">y =</span> <span class="st">&quot;Expectativida de vida em anos&quot;</span>,
       <span class="dt">title =</span> <span class="st">&quot;Relação entre PIB per capita e expectativida de vida&quot;</span>,
       <span class="dt">subtitle =</span> <span class="st">&quot;Existe uma correlação positiva entre as duas variáveis&quot;</span>,
       <span class="co"># Aqui usamos &#39;\n&#39;, um character especial do R, para</span>
       <span class="co"># adicioanar uma quebra de linha </span>
       <span class="dt">color =</span> <span class="st">&quot;Continente</span><span class="ch">\n</span><span class="st"> do país&quot;</span>,
       <span class="dt">caption =</span> <span class="st">&quot;Autor: Eu&quot;</span>)</code></pre></div>
<pre><code>## Warning: Removed 7 rows containing missing values (geom_point).</code></pre>
<p><img src="curso_visualizacao_files/figure-html/unnamed-chunk-129-1.png" width="672" /></p>
<div class="alert alert-info" <strong="">
<p>Referências:</strong> <a href="https://ggplot2.tidyverse.org/reference/labs.html"><code>labs()</code></a></p>
</div>
</div>
<div id="extensoes-do-ggplot2" class="section level2">
<h2><span class="header-section-number">3.11</span> Extensões do ggplot2</h2>
<p>O <code>ggplot2</code> é tão flexível e popular que se criou uma comunidade enorme em torno no pacote. Aos poucos, outros programadores foram criando extensões para o pacote que fornecem ainda mais opções de visualizações para o usuário comum.</p>
<div class="alert alert-info" <strong="">
<p>Referências:</strong> <a href="http://ggplot2-exts.org/">Extensões do <code>ggplot2</code></a></p>
</div>
</div>
<div id="exercicios-2" class="section level2">
<h2><span class="header-section-number">3.12</span> Exercícios</h2>
<ol style="list-style-type: decimal">
<li><p>Importe o arquivo salvo <code>herois_completo.csv</code> no primeiro módulo. Salve no objeto <code>herois</code>. Filtre os herois que possuem peso e altura maior que 0.</p></li>
<li><p>Crie um histograma da variável altura.</p></li>
<li><p>Analise a distribuição da variável peso em função da editora dos heróis.</p></li>
<li><p>Crie um gŕafico de barras mostrando a quantidade de heróis por editora. Ordene as barras em ordem descrescente. Acrescente uma camada de texto nas barras mostrando a quantidade exata.</p></li>
<li><p>Crie um gráfico de barras mostrando a quantidade de herois bons, maus ou neutros (variável <code>alignment</code>) por editora. Use tanto <code>geom_bar()</code> como <code>geom_col()</code> para isso, usando o argumento <code>position = position_dodge()</code> para separar as barras nas editoras.</p></li>
<li><p>Repita o item anterior, trocando apenas o parâmeto <code>position = position_dodge()</code> para <code>position = position_fill()</code> para observar a proporção de personagens bons, maus ou neutros em cada editora.</p></li>
<li><p>Use o dplyr e o tidyr para criar um dataset chamado <code>hero_agg</code>, que contem a quantidade de poderes agregado por editora e heroi. Dica: transforme as colunas de super-poderes em numéricas, converta o dataframe para formato tidy, agrupe os dados por editora e heroi e calcule a soma da coluna transformada de poderes.</p></li>
<li><p>Faça um gráfico de barras mostrando os 10 herois de cada editora que possuem mais poderes. Dica: use facets para separa os herois de cada editora, usando <code>scales = &quot;free_y&quot; e drop = TRUE</code>. Inverta os eixos.</p></li>
<li><p>Faça um gráfico de densidade da distribuição da quantidade de poderes dos herois por editora. Use o parâmetro <code>alpha</code> para aumentar a transparência das curvas.</p></li>
<li><p>Para praticar com gráficos de séries temporais, usaremos outro dataset. Importe o dataset <code>economics</code> usando a função <code>data()</code>. Observe os dados com a função <code>head()</code>. Qual a periodicidade temporal dos dados (ex.: diário, semanal, mensal, anual) ?</p></li>
<li><p>Faça um gráfico da variável <code>unemploy</code> ao longo do tempo. Salve esse gráfico no objeto p, que será usado nos próximos itens.</p></li>
<li><p>Acrescente uma camada de área sombreada destacando o período entre 2001 a 2005.</p></li>
<li><p>Acrescente algum comentário seu no gráfico usando a função <code>geom_text()</code>.</p></li>
<li><p>Transforme o dataframe <code>economics</code> para o formato tidy. Faça um gráfico de linha de todos os indicadores econômicos ao longo do tempo, mapeando a <em>aesthetic</em> color à variável do nome do indicador. Note os problemas de escala do gráfico.</p></li>
<li><p>Repita o item anterior, acrescentando uma camada de facets que separe os gráficos por indicador. Defina o parâmetro <code>scales</code> para ter escala livre no eixo y.</p></li>
</ol>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="introducao-ao-ggplot2.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="outros-tipos-de-graficos.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": false,
"google": false,
"linkedin": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": null,
"download": null,
"toc": {
"collapse": "subsection",
"scroll_highlight": true
},
"toolbar": {
"position": "fixed"
},
"search": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
